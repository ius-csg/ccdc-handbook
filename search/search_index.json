{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"CCDC Handbook Current Homework Get a Virtual Machine of your OS. Read https://wiki.archlinux.org/ https://www.digitalocean.com/docs/ Things to know how to do on your box Know how to get System information What is your system/name? What is the version? Who are the users are on the machine right now? What running processes are there? What Ports are opened and closed? How to change a port from open to closed and vise versa? Know what attacks are common for your box Roles Team Captain Gopher Firewall Admin Linux Admin Windows Admin Web Admin Client Services Incident Responder This list is in order of importance Schedule To be determined","title":"CCDC Handbook"},{"location":"#ccdc-handbook","text":"","title":"CCDC Handbook"},{"location":"#current-homework","text":"Get a Virtual Machine of your OS. Read https://wiki.archlinux.org/ https://www.digitalocean.com/docs/","title":"Current Homework"},{"location":"#things-to-know-how-to-do-on-your-box","text":"","title":"Things to know how to do on your box"},{"location":"#know-how-to-get-system-information","text":"What is your system/name? What is the version? Who are the users are on the machine right now? What running processes are there? What Ports are opened and closed? How to change a port from open to closed and vise versa?","title":"Know how to get System information"},{"location":"#know-what-attacks-are-common-for-your-box","text":"","title":"Know what attacks are common for your box"},{"location":"#roles","text":"Team Captain Gopher Firewall Admin Linux Admin Windows Admin Web Admin Client Services Incident Responder This list is in order of importance","title":"Roles"},{"location":"#schedule","text":"","title":"Schedule"},{"location":"#to-be-determined","text":"","title":"To be determined"},{"location":"Palo-Alto-Firewall/","text":"Palo Alto Firewall As I Zac Clifton get the firewall we have order I shall start posting information for the future firewall adminastrator in CSG. And to whomever becomes by addprentice I wish you the best of luck for I am in the same boat you are in now. THe real world with no clue on how to use a firewall. group-by example","title":"Palo Alto Firewall"},{"location":"Palo-Alto-Firewall/#palo-alto-firewall","text":"As I Zac Clifton get the firewall we have order I shall start posting information for the future firewall adminastrator in CSG. And to whomever becomes by addprentice I wish you the best of luck for I am in the same boat you are in now. THe real world with no clue on how to use a firewall. group-by example","title":"Palo Alto Firewall"},{"location":"Playbook/","text":"Playbook In the first hour Change default passwords Windows SSH/Linux Web Applications / Administration Databases Document OS version and services For next year this will be very helpful as this will provide a basis to work off of. Write it down in a notepad and after the contest finishes we will aggregate the information and store it in the handbook.","title":"Playbook"},{"location":"Playbook/#playbook","text":"","title":"Playbook"},{"location":"Playbook/#in-the-first-hour","text":"","title":"In the first hour"},{"location":"Playbook/#change-default-passwords","text":"Windows SSH/Linux Web Applications / Administration Databases","title":"Change default passwords"},{"location":"Playbook/#document-os-version-and-services","text":"For next year this will be very helpful as this will provide a basis to work off of. Write it down in a notepad and after the contest finishes we will aggregate the information and store it in the handbook.","title":"Document OS version and services"},{"location":"Resources/","text":"Resources General Team Packet How to Win CCDC How to Win CCDC - Medium Article Resources from competition website Our competitors - Tech Cyber Warriors A Red Teamer's GitHub repo for CCDC stuff OSSEC Linux Linux Handbook CentOs guide Windows Active Directory Resources from brandon simple-windows-batch-scripting-intrusion-discovery ID-Windows cheat-sheets nsa-windows-event ATA Playbook CCDC Writeup Justin Schwarz CCDC Write up ccdcreview_evans","title":"Resources"},{"location":"Resources/#resources","text":"","title":"Resources"},{"location":"Resources/#general","text":"Team Packet How to Win CCDC How to Win CCDC - Medium Article Resources from competition website Our competitors - Tech Cyber Warriors A Red Teamer's GitHub repo for CCDC stuff OSSEC","title":"General"},{"location":"Resources/#linux","text":"Linux Handbook CentOs guide","title":"Linux"},{"location":"Resources/#windows","text":"Active Directory","title":"Windows"},{"location":"Resources/#resources-from-brandon","text":"simple-windows-batch-scripting-intrusion-discovery ID-Windows cheat-sheets nsa-windows-event ATA Playbook CCDC Writeup Justin Schwarz CCDC Write up ccdcreview_evans","title":"Resources from brandon"},{"location":"Boxes/Centos-Web-Server/","text":"Centos Web Server This browser does not support PDFs. Please download the PDF to view it: Download PDF . List Services without iptables for service in /etc/init.d/*; do if [[ $(basename $service) != \"iptables\" ]]; then sudo service $(basename $service) status; fi; done","title":"Centos Web Server"},{"location":"Boxes/Centos-Web-Server/#centos-web-server","text":"This browser does not support PDFs. Please download the PDF to view it: Download PDF .","title":"Centos Web Server"},{"location":"Boxes/Centos-Web-Server/#list-services-without-iptables","text":"for service in /etc/init.d/*; do if [[ $(basename $service) != \"iptables\" ]]; then sudo service $(basename $service) status; fi; done","title":"List Services without iptables"},{"location":"Boxes/Fedora-Email/","text":"Fedora Email The Fedora 25 email server is running the Postfix MTA (Mail Transfer Agent) for SMTP. This is usually done with TCP port 25 and TCP port 465. The Dovecot IMAP and POP3 server also could be running, which allows mail retrieval from a server. IMAP usually uses TCP 143 for unsecure connections, and 993 for IMAP over SSL. POP3 uses TCP 110 for unsecure connections, and TCP 995 for POP3 over SSL/TLS. Postfix Postfix has literally hundreds of config options. These options are usually stored in the /etc/postfix directory. The main.cf files contains config options, and master.cf which specifies what services it should run. Postconf The command-line tool postconf is usually used to modify the master.cf file rather than editing it by hand. Service management Postfix seems to do its own service management using the postfix command. Hardening and DSAs CVEs for Postfix Links https://linux-audit.com/postfix-hardening-guide-for-security-and-privacy/ Dovecot Dovecot config files are stored in /etc/dovecot/dovecot.conf and /etc/dovecot/conf.d/* Hardening and DSAs Don't put the dovecot user in the mail group! Info CVEs for Dovecot Fail2Ban Directions Users Users are being pulled over LDAP from the Windows AD machine. DNS Mail servers usually require special A and MX records. Resources https://wiki.archlinux.org/index.php/Virtual_user_mail_system_with_Postfix,_Dovecot_and_Roundcube https://www.digitalocean.com/community/tutorials/how-to-set-up-a-postfix-e-mail-server-with-dovecot","title":"Fedora Email"},{"location":"Boxes/Fedora-Email/#fedora-email","text":"The Fedora 25 email server is running the Postfix MTA (Mail Transfer Agent) for SMTP. This is usually done with TCP port 25 and TCP port 465. The Dovecot IMAP and POP3 server also could be running, which allows mail retrieval from a server. IMAP usually uses TCP 143 for unsecure connections, and 993 for IMAP over SSL. POP3 uses TCP 110 for unsecure connections, and TCP 995 for POP3 over SSL/TLS.","title":"Fedora Email"},{"location":"Boxes/Fedora-Email/#postfix","text":"Postfix has literally hundreds of config options. These options are usually stored in the /etc/postfix directory. The main.cf files contains config options, and master.cf which specifies what services it should run.","title":"Postfix"},{"location":"Boxes/Fedora-Email/#postconf","text":"The command-line tool postconf is usually used to modify the master.cf file rather than editing it by hand.","title":"Postconf"},{"location":"Boxes/Fedora-Email/#service-management","text":"Postfix seems to do its own service management using the postfix command.","title":"Service management"},{"location":"Boxes/Fedora-Email/#hardening-and-dsas","text":"CVEs for Postfix","title":"Hardening and DSAs"},{"location":"Boxes/Fedora-Email/#links","text":"https://linux-audit.com/postfix-hardening-guide-for-security-and-privacy/","title":"Links"},{"location":"Boxes/Fedora-Email/#dovecot","text":"Dovecot config files are stored in /etc/dovecot/dovecot.conf and /etc/dovecot/conf.d/*","title":"Dovecot"},{"location":"Boxes/Fedora-Email/#hardening-and-dsas_1","text":"Don't put the dovecot user in the mail group! Info CVEs for Dovecot Fail2Ban Directions","title":"Hardening and DSAs"},{"location":"Boxes/Fedora-Email/#users","text":"Users are being pulled over LDAP from the Windows AD machine.","title":"Users"},{"location":"Boxes/Fedora-Email/#dns","text":"Mail servers usually require special A and MX records.","title":"DNS"},{"location":"Boxes/Fedora-Email/#resources","text":"https://wiki.archlinux.org/index.php/Virtual_user_mail_system_with_Postfix,_Dovecot_and_Roundcube https://www.digitalocean.com/community/tutorials/how-to-set-up-a-postfix-e-mail-server-with-dovecot","title":"Resources"},{"location":"Boxes/Ubuntu-DNS/","text":"Ubuntu DNS BIND DNS The Ubuntu server is likely running the BIND DNS server which will contain A and MX records for the other machines. The config file is located at /etc/named.conf Default ports: 53/tcp - DNS queries ??? DSAs for BIND Archwiki - BIND BIND Ubunutu setup - DO MySQL A SQL server will also likely be present for use on the eCommerce/CentOS box.","title":"Ubuntu DNS"},{"location":"Boxes/Ubuntu-DNS/#ubuntu-dns","text":"","title":"Ubuntu DNS"},{"location":"Boxes/Ubuntu-DNS/#bind-dns","text":"The Ubuntu server is likely running the BIND DNS server which will contain A and MX records for the other machines. The config file is located at /etc/named.conf Default ports: 53/tcp - DNS queries ??? DSAs for BIND Archwiki - BIND BIND Ubunutu setup - DO","title":"BIND DNS"},{"location":"Boxes/Ubuntu-DNS/#mysql","text":"A SQL server will also likely be present for use on the eCommerce/CentOS box.","title":"MySQL"},{"location":"Boxes/Windows-AD/","text":"Windows 2008R2 AD Ports expected & firewall setup Setting a password policy IPS/IDS Domain firewall settings Useful GPO options Useful registry changes","title":"Windows 2008R2 AD"},{"location":"Boxes/Windows-AD/#windows-2008r2-ad","text":"","title":"Windows 2008R2 AD"},{"location":"Boxes/Windows-AD/#ports-expected-firewall-setup","text":"","title":"Ports expected &amp; firewall setup"},{"location":"Boxes/Windows-AD/#setting-a-password-policy","text":"","title":"Setting a password policy"},{"location":"Boxes/Windows-AD/#ipsids","text":"","title":"IPS/IDS"},{"location":"Boxes/Windows-AD/#domain-firewall-settings","text":"","title":"Domain firewall settings"},{"location":"Boxes/Windows-AD/#useful-gpo-options","text":"","title":"Useful GPO options"},{"location":"Boxes/Windows-AD/#useful-registry-changes","text":"","title":"Useful registry changes"},{"location":"Linux/","text":"General Linux Team Stratagy - First Hour CHANGE DEFAULT PASSWORDS!!!!!! Lock all unused user accounts Kill all unneeded services Kill IPv6 Basic firewall rules Preform scans - rkhunter, lynis Setup IDS Patch Linux Boxes Debian mail server probably with dovecot / postfix - Adam CentOS 5.9 with Joomla - Jason Ubuntu with BIND dns - Bryan Directory Tools Services","title":"Index"},{"location":"Linux/#general-linux-team-stratagy-first-hour","text":"CHANGE DEFAULT PASSWORDS!!!!!! Lock all unused user accounts Kill all unneeded services Kill IPv6 Basic firewall rules Preform scans - rkhunter, lynis Setup IDS Patch","title":"General Linux Team Stratagy - First Hour"},{"location":"Linux/#linux-boxes","text":"Debian mail server probably with dovecot / postfix - Adam CentOS 5.9 with Joomla - Jason Ubuntu with BIND dns - Bryan","title":"Linux Boxes"},{"location":"Linux/#directory","text":"Tools Services","title":"Directory"},{"location":"Linux/services/","text":"Cron Cron is a simple time based job scheduler. Cron configuation files (crontabs) can be configured for the system, and for indiviual users. User crontabs are usually located at /var/spool/cron/crontab . The position of system crontabs varies, but can usually be found under /etc . To list the crontab of every user in the system: for user in $(sudo cut -f1 -d: /etc/passwd); do sudo crontab -u $user -l && echo ^$user; done Or use the Crontabs script from the scripts repo. For a default Install there is no crontabs set up. If there is any added it is because of two reasons: It's there for an application to function correctly Or It's malicious intent. If it's malicious intent then we should remove it from that user. type crontab -u [the-user-name] -e . This will put you into a vim editor. It might be unfamiliar at first. This allows you to edit the crontab. Or, use crontab -u [USERNAME] -r to completely remove it. See also: DigitalOcean read about vim to know how to edit this text file Apache mod-security - sql injection defense PHP PHP Hardening - disable command line execution functions Patching PHP vulnerabilities","title":"Services"},{"location":"Linux/services/#cron","text":"Cron is a simple time based job scheduler. Cron configuation files (crontabs) can be configured for the system, and for indiviual users. User crontabs are usually located at /var/spool/cron/crontab . The position of system crontabs varies, but can usually be found under /etc . To list the crontab of every user in the system: for user in $(sudo cut -f1 -d: /etc/passwd); do sudo crontab -u $user -l && echo ^$user; done Or use the Crontabs script from the scripts repo. For a default Install there is no crontabs set up. If there is any added it is because of two reasons: It's there for an application to function correctly Or It's malicious intent. If it's malicious intent then we should remove it from that user. type crontab -u [the-user-name] -e . This will put you into a vim editor. It might be unfamiliar at first. This allows you to edit the crontab. Or, use crontab -u [USERNAME] -r to completely remove it. See also: DigitalOcean read about vim to know how to edit this text file","title":"Cron"},{"location":"Linux/services/#apache","text":"mod-security - sql injection defense","title":"Apache"},{"location":"Linux/services/#php","text":"PHP Hardening - disable command line execution functions Patching PHP vulnerabilities","title":"PHP"},{"location":"Linux/tools/","text":"Linux Tools Firewall UFW UFW (Uncomplicated FireWall) is a simple wrapper for the Linux kernel's iptables firewall. To enable the firewall: ufw enable DANGER: By default, this will block ALL incoming traffic unless otherwise configured! To allow SSH: ufw allow ssh OR ufw allow in 22/tcp In general, the syntax is ufw allow|deny|reject in|out port|app/tcp|udp To list current rules: ufw status verbose To deny an IP or range to all ports: ufw deny from IP/CIDR See also: ArchWiki IPtables IPtables is the Linux kernel's built in firewall. While more complex, it offers more features than a front-end and is found on all Linux systems. Please try to use UFW, detailed in the above section, if possible. To view current IPtables rules: iptables -nvL To give an example of output information, Chain INPUT (policy ACCEPT 0 packets, 0 bytes) indicates that by default, all INPUT data (incoming) will be ACCEPTed. To change the Chain default: iptables -P <CHAIN> <ACCEPT|REJECT|DROP> To allow SSH traffic over TCP port 22: iptables -A INPUT -p tcp --dport 22 -j ACCEPT By default, rules are not preserved on system reboot. See also: DigitalOcean Security Lynis Lynis is a Linux security auditing tool which scans the entire system and some running processes and reccomends specific hardening. To use, download from GitHub and run ./lynis audit system . A long list of suggestions and warnings will be output. A custom auditing profile can be found in the scripts repo, but is not required. RKhunter RKhunter is a Linux rootkit and backdoor scanner avalible in most repos. It checks for known backdoors, wrong file permissions, and checksums some binaries. To run all checks (requires root): rkhunter --check By default, the output is logged at /var/log/rkhunter.log See also: Techmint SUSE Wiki User Whowatch Whowatch is a realtime user and process monitor. It interactivly shows the output of the w command, and allows you to kill the users login and processes from the TUI. To launch, use the command whowatch . While in the TUI, press s to view system info, or t to view the process tree. See also: TechMint User information To see all logged in users, from where, and what they are doing, use the w command. To list all user accounts on the system, see the /etc/passwd file. All users in the 'root' group or with UID 0, or named 'root' have superuser access. Example: root:x:0:0:root:/root:/bin/bash Is a superuser because the account is named root. It is also the superuser because it has user ID 0, and has group root. For more details on user entries, see ArchWiki . Other user info commands: last - Displays login log for the system. lastb - Shows unsuccessful logins for the system. System Network Interfaces type ifconfig -a to show show all interfaces and their ip address eth0 Link encap:Ethernet HWaddr 00:0C:29:ED:4F:17 inet addr:192.168.5.28 Bcast:192.168.5.255 Mask:255.255.255.0 UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1 RX packets:434745 errors:0 dropped:0 overruns:0 frame:0 TX packets:8451 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1000 RX bytes:73297381 (69.9 MiB) TX bytes:706961 (690.3 KiB) lo Link encap:Local Loopback inet addr:127.0.0.1 Mask:255.0.0.0 UP LOOPBACK RUNNING MTU:16436 Metric:1 RX packets:608 errors:0 dropped:0 overruns:0 frame:0 TX packets:608 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:0 RX bytes:86289 (84.2 KiB) TX bytes:86289 (84.2 KiB) eht0 is your network interface connected to the network. It might have a different name depending on the linux operating system you are using though. lo is your loopback interface which just means it loops back to you (localhost). Show sockets To see socket statistics on your machine, use the ss command. Options of intrest: ss -lp - Shows all listening ports and the process listening ss -t Show all TCP sockets Process management top - List running processes, or tasks pkill <name> - Sends SIGTERM to the specified process, matching the specified name. SIGTERM is a request for a graceful termination. List Services debian service --status-all centOS - excluding iptables so if the firewall has a long list it doesn't blind you. for service in /etc/init.d/*; do if [[ $(basename $service) != \"iptables\" ]]; then sudo service $(basename $service) status | grep \"is running\"; fi; done Utilities Vim Vim can be very daunting when first using it. It is the default editor in linux for many programs so you should know what to do if you are presented with vim ex. (crontab will default with vim when trying to edit the cron) To open a file with vim you can type vim somefile.txt . You are now in the editor and you will notice if you try to type something that it won't write. This is because vim is listening for commands. In order to type in the text file you must turn it to insert mode by pressing the i key. Once you get done making your edits you will need to exit INSERT mode by pressing the escape key. Now to save your edits you will need to access vim's command line. You can do this by pressing the : (colon) key. Now type wq and ENTER to write (w) and quit(q). If you need to exit without saving the command is q! .","title":"Linux Tools"},{"location":"Linux/tools/#linux-tools","text":"","title":"Linux Tools"},{"location":"Linux/tools/#firewall","text":"","title":"Firewall"},{"location":"Linux/tools/#ufw","text":"UFW (Uncomplicated FireWall) is a simple wrapper for the Linux kernel's iptables firewall. To enable the firewall: ufw enable DANGER: By default, this will block ALL incoming traffic unless otherwise configured! To allow SSH: ufw allow ssh OR ufw allow in 22/tcp In general, the syntax is ufw allow|deny|reject in|out port|app/tcp|udp To list current rules: ufw status verbose To deny an IP or range to all ports: ufw deny from IP/CIDR See also: ArchWiki","title":"UFW"},{"location":"Linux/tools/#iptables","text":"IPtables is the Linux kernel's built in firewall. While more complex, it offers more features than a front-end and is found on all Linux systems. Please try to use UFW, detailed in the above section, if possible. To view current IPtables rules: iptables -nvL To give an example of output information, Chain INPUT (policy ACCEPT 0 packets, 0 bytes) indicates that by default, all INPUT data (incoming) will be ACCEPTed. To change the Chain default: iptables -P <CHAIN> <ACCEPT|REJECT|DROP> To allow SSH traffic over TCP port 22: iptables -A INPUT -p tcp --dport 22 -j ACCEPT By default, rules are not preserved on system reboot. See also: DigitalOcean","title":"IPtables"},{"location":"Linux/tools/#security","text":"","title":"Security"},{"location":"Linux/tools/#lynis","text":"Lynis is a Linux security auditing tool which scans the entire system and some running processes and reccomends specific hardening. To use, download from GitHub and run ./lynis audit system . A long list of suggestions and warnings will be output. A custom auditing profile can be found in the scripts repo, but is not required.","title":"Lynis"},{"location":"Linux/tools/#rkhunter","text":"RKhunter is a Linux rootkit and backdoor scanner avalible in most repos. It checks for known backdoors, wrong file permissions, and checksums some binaries. To run all checks (requires root): rkhunter --check By default, the output is logged at /var/log/rkhunter.log See also: Techmint SUSE Wiki","title":"RKhunter"},{"location":"Linux/tools/#user","text":"","title":"User"},{"location":"Linux/tools/#whowatch","text":"Whowatch is a realtime user and process monitor. It interactivly shows the output of the w command, and allows you to kill the users login and processes from the TUI. To launch, use the command whowatch . While in the TUI, press s to view system info, or t to view the process tree. See also: TechMint","title":"Whowatch"},{"location":"Linux/tools/#user-information","text":"To see all logged in users, from where, and what they are doing, use the w command. To list all user accounts on the system, see the /etc/passwd file. All users in the 'root' group or with UID 0, or named 'root' have superuser access. Example: root:x:0:0:root:/root:/bin/bash Is a superuser because the account is named root. It is also the superuser because it has user ID 0, and has group root. For more details on user entries, see ArchWiki . Other user info commands: last - Displays login log for the system. lastb - Shows unsuccessful logins for the system.","title":"User information"},{"location":"Linux/tools/#system","text":"","title":"System"},{"location":"Linux/tools/#network","text":"","title":"Network"},{"location":"Linux/tools/#interfaces","text":"type ifconfig -a to show show all interfaces and their ip address eth0 Link encap:Ethernet HWaddr 00:0C:29:ED:4F:17 inet addr:192.168.5.28 Bcast:192.168.5.255 Mask:255.255.255.0 UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1 RX packets:434745 errors:0 dropped:0 overruns:0 frame:0 TX packets:8451 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1000 RX bytes:73297381 (69.9 MiB) TX bytes:706961 (690.3 KiB) lo Link encap:Local Loopback inet addr:127.0.0.1 Mask:255.0.0.0 UP LOOPBACK RUNNING MTU:16436 Metric:1 RX packets:608 errors:0 dropped:0 overruns:0 frame:0 TX packets:608 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:0 RX bytes:86289 (84.2 KiB) TX bytes:86289 (84.2 KiB) eht0 is your network interface connected to the network. It might have a different name depending on the linux operating system you are using though. lo is your loopback interface which just means it loops back to you (localhost).","title":"Interfaces"},{"location":"Linux/tools/#show-sockets","text":"To see socket statistics on your machine, use the ss command. Options of intrest: ss -lp - Shows all listening ports and the process listening ss -t Show all TCP sockets","title":"Show sockets"},{"location":"Linux/tools/#process-management","text":"top - List running processes, or tasks pkill <name> - Sends SIGTERM to the specified process, matching the specified name. SIGTERM is a request for a graceful termination.","title":"Process management"},{"location":"Linux/tools/#list-services","text":"debian service --status-all centOS - excluding iptables so if the firewall has a long list it doesn't blind you. for service in /etc/init.d/*; do if [[ $(basename $service) != \"iptables\" ]]; then sudo service $(basename $service) status | grep \"is running\"; fi; done","title":"List Services"},{"location":"Linux/tools/#utilities","text":"","title":"Utilities"},{"location":"Linux/tools/#vim","text":"Vim can be very daunting when first using it. It is the default editor in linux for many programs so you should know what to do if you are presented with vim ex. (crontab will default with vim when trying to edit the cron) To open a file with vim you can type vim somefile.txt . You are now in the editor and you will notice if you try to type something that it won't write. This is because vim is listening for commands. In order to type in the text file you must turn it to insert mode by pressing the i key. Once you get done making your edits you will need to exit INSERT mode by pressing the escape key. Now to save your edits you will need to access vim's command line. You can do this by pressing the : (colon) key. Now type wq and ENTER to write (w) and quit(q). If you need to exit without saving the command is q! .","title":"Vim"},{"location":"Windows/","text":"Index General Windows strategy Change default passwords Disable all unused user accounts (Default Admin and Guest accounts too) Remove all unnecessary roles and features Kill all unneeded services and processes Turn firewall on and configure properly Install and prepare OSSEC IDS Leave UAC on Boxes Windows 2012 Web server - Thomas Windows 2008 R2 Active Directory / DNS - Matthew Windows server 2003 FTP - James (powershell might not be installed, so know both cmd and powershell or how to activate powershell) Windows 7 / Firewall client - Johny - you will have to work with Zac on the Palo Alto Directories Account Managment Powershell Services Tools","title":"Index"},{"location":"Windows/#index","text":"","title":"Index"},{"location":"Windows/#general-windows-strategy","text":"Change default passwords Disable all unused user accounts (Default Admin and Guest accounts too) Remove all unnecessary roles and features Kill all unneeded services and processes Turn firewall on and configure properly Install and prepare OSSEC IDS Leave UAC on","title":"General Windows strategy"},{"location":"Windows/#boxes","text":"Windows 2012 Web server - Thomas Windows 2008 R2 Active Directory / DNS - Matthew Windows server 2003 FTP - James (powershell might not be installed, so know both cmd and powershell or how to activate powershell) Windows 7 / Firewall client - Johny - you will have to work with Zac on the Palo Alto","title":"Boxes"},{"location":"Windows/#directories","text":"Account Managment Powershell Services Tools","title":"Directories"},{"location":"Windows/Local%20accounts/","text":"Local Account Management These commands apply only to local user accounts, and are unlikely to influence Windows AD domain accounts. All of the following commands are via command prompt Creating New Users net user /add [name] [password] Creating new groups net localgroup [Group Name] /add Adding a user to a group Net localgroup [Group Name] [User Name] /add All of the above commands have a /delete option as well, however it is normally better to disable accounts rather than delete them. This can be accomplished with the following: net user [Username] /active{yes|no} Disabling default accounts Important step The built in Administrator and Guest accounts are often insecure, thus disabling them as follows would be desirable. This may be also done via AD group policy. net Administrator /active:no net Guest /active:no However, it is important to replace the admin account with another admin of your own creation in order to prevent becoming locked out of the system. This can be accomplished by creating a user and adding them to the \"Administrators\" group as follows: Net user /add NewAdmin $eCuR3P@S$W0rd Net localgroup Administrators NewAdmin /add This will add the user \"NewAdmin\" with password $eCuR3P@S$W0rd and then put them in the Administrators group. Changing default passwords Important step For a list of users use: net user From that list of users one can manually reset a password using net user [username] [new password]","title":"Local Account Management"},{"location":"Windows/Local%20accounts/#local-account-management","text":"These commands apply only to local user accounts, and are unlikely to influence Windows AD domain accounts. All of the following commands are via command prompt","title":"Local Account Management"},{"location":"Windows/Local%20accounts/#creating-new-users","text":"net user /add [name] [password]","title":"Creating New Users"},{"location":"Windows/Local%20accounts/#creating-new-groups","text":"net localgroup [Group Name] /add","title":"Creating new groups"},{"location":"Windows/Local%20accounts/#adding-a-user-to-a-group","text":"Net localgroup [Group Name] [User Name] /add All of the above commands have a /delete option as well, however it is normally better to disable accounts rather than delete them. This can be accomplished with the following: net user [Username] /active{yes|no}","title":"Adding a user to a group"},{"location":"Windows/Local%20accounts/#disabling-default-accounts","text":"Important step The built in Administrator and Guest accounts are often insecure, thus disabling them as follows would be desirable. This may be also done via AD group policy. net Administrator /active:no net Guest /active:no However, it is important to replace the admin account with another admin of your own creation in order to prevent becoming locked out of the system. This can be accomplished by creating a user and adding them to the \"Administrators\" group as follows: Net user /add NewAdmin $eCuR3P@S$W0rd Net localgroup Administrators NewAdmin /add This will add the user \"NewAdmin\" with password $eCuR3P@S$W0rd and then put them in the Administrators group.","title":"Disabling default accounts"},{"location":"Windows/Local%20accounts/#changing-default-passwords","text":"Important step For a list of users use: net user From that list of users one can manually reset a password using net user [username] [new password]","title":"Changing default passwords"},{"location":"Windows/Powershell/","text":"Powershell Basics Finding out more about any given command Get-help [Command] Great way to discover new commands Get-Command Get-Command -Noun Get-Command by itself will simply spew out all commands currently installed.The noun option allows you to look for commands that affect any given noun. For example, when the string \"Service\" is used powershell will show all commands that involve Services. Often a command will give much more output than is desired. If searching for a specific property, such as name, the select command can be used to filter out all the unnecessary information Get-Service | select Name The above command will first retrieve the information about the services, but then will only display the selected attribute, the names. Discovering the System Environment Variables Environment variables can be used to discover many system properties. All environment variables are in the form \"$env: \" where is the name of the specific variable. A couple of useful environment variables are listed below. $env:OS $env:ComputerName $env:Username There are many other environment variables. Processes & Services Another point of interest on the system is discovering process and services.This is simple to do in powershell. Get-EventLog requires the name of the log that is to be retrieved (Ex/ Application) Get-Process Get-Service Get-Eventlog Remember the use of \"Get-Command -Noun \" can be used to discover other commands that could interact with the Process or Service is those keywords are passed to the -Noun Option Users Discovering the users is an important step in the administrative process. This includes both the names of users and, more importantly, the groups that those users are a part of. Get-WmiObject Win32_useraccount Get-WmiObject Win32_group Get-WmiObject Win32_groupuser These commands will display the user accounts, groups, and users contained in a specific group respectively. Administrative users are very important to keep track of so this script displays some account information of every administer on the local computer. Get-WmiObject win32_groupuser | Where-Object { $_.groupcomponent -match 'administrators' } | ForEach-Object {[wmi]$_.partcomponent} Once this information is discovered it may be desirable to discover more about the user accounts or change some attributes of the account. In order to do this a varible containing an User object can be created. [adsi]$userVar = \"winNT://<ComputerName>/<username>\" Where is the name of the computer the account is on is the name of the account After creation the User Variable's properties can be examined or changed. $userVar.lastlogin $userVar.badpasswordattempts $userVar.setpassword(\"CantPwnMe\") Invoking these commands will display the property or change it as appropriate. There are many other properties, these are but a few interesting examples.","title":"Powershell Basics"},{"location":"Windows/Powershell/#powershell-basics","text":"Finding out more about any given command Get-help [Command] Great way to discover new commands Get-Command Get-Command -Noun Get-Command by itself will simply spew out all commands currently installed.The noun option allows you to look for commands that affect any given noun. For example, when the string \"Service\" is used powershell will show all commands that involve Services. Often a command will give much more output than is desired. If searching for a specific property, such as name, the select command can be used to filter out all the unnecessary information Get-Service | select Name The above command will first retrieve the information about the services, but then will only display the selected attribute, the names.","title":"Powershell Basics"},{"location":"Windows/Powershell/#discovering-the-system","text":"","title":"Discovering the System"},{"location":"Windows/Powershell/#environment-variables","text":"Environment variables can be used to discover many system properties. All environment variables are in the form \"$env: \" where is the name of the specific variable. A couple of useful environment variables are listed below. $env:OS $env:ComputerName $env:Username There are many other environment variables.","title":"Environment Variables"},{"location":"Windows/Powershell/#processes-services","text":"Another point of interest on the system is discovering process and services.This is simple to do in powershell. Get-EventLog requires the name of the log that is to be retrieved (Ex/ Application) Get-Process Get-Service Get-Eventlog Remember the use of \"Get-Command -Noun \" can be used to discover other commands that could interact with the Process or Service is those keywords are passed to the -Noun Option","title":"Processes &amp; Services"},{"location":"Windows/Powershell/#users","text":"Discovering the users is an important step in the administrative process. This includes both the names of users and, more importantly, the groups that those users are a part of. Get-WmiObject Win32_useraccount Get-WmiObject Win32_group Get-WmiObject Win32_groupuser These commands will display the user accounts, groups, and users contained in a specific group respectively. Administrative users are very important to keep track of so this script displays some account information of every administer on the local computer. Get-WmiObject win32_groupuser | Where-Object { $_.groupcomponent -match 'administrators' } | ForEach-Object {[wmi]$_.partcomponent} Once this information is discovered it may be desirable to discover more about the user accounts or change some attributes of the account. In order to do this a varible containing an User object can be created. [adsi]$userVar = \"winNT://<ComputerName>/<username>\" Where is the name of the computer the account is on is the name of the account After creation the User Variable's properties can be examined or changed. $userVar.lastlogin $userVar.badpasswordattempts $userVar.setpassword(\"CantPwnMe\") Invoking these commands will display the property or change it as appropriate. There are many other properties, these are but a few interesting examples.","title":"Users"},{"location":"Windows/Tools/","text":"Tools Event Viewer This is a built in tool for monitoring the local system. Exploration and familiarization of this tool is crucial in understanding an attack on the system. For a gentle introduction follow along with: Event Viewer Walkthrough Autoruns This tool is used to display what programs are configured to run at boot. This can be very useful in detecting malicous scripts as well as minimizing attack surface. Familiarization of this tool, as well as, the knowledge of which scripts are necessary to the machine could be crucial. Check out this video for a guided approach: Advanced autoruns tutorial Process Viewer This tool can be used to monitor all processes and view some information about what that process is doing, for example what files they have open. Follow along with: Process Viewer Guide TCP View This tool provides detailed information about the network communications of the local computer and can be used to monitor for malicious programs attempting to steal data For a brief overview: TCP View overview AD Password Control & Bulk Password Control This tool is designed to allow for Domain wide account control and includes a random password generator. For the basic functionality: Password Control For bulk control: Bulk Password Control","title":"Tools"},{"location":"Windows/Tools/#tools","text":"","title":"Tools"},{"location":"Windows/Tools/#event-viewer","text":"This is a built in tool for monitoring the local system. Exploration and familiarization of this tool is crucial in understanding an attack on the system. For a gentle introduction follow along with: Event Viewer Walkthrough","title":"Event Viewer"},{"location":"Windows/Tools/#autoruns","text":"This tool is used to display what programs are configured to run at boot. This can be very useful in detecting malicous scripts as well as minimizing attack surface. Familiarization of this tool, as well as, the knowledge of which scripts are necessary to the machine could be crucial. Check out this video for a guided approach: Advanced autoruns tutorial","title":"Autoruns"},{"location":"Windows/Tools/#process-viewer","text":"This tool can be used to monitor all processes and view some information about what that process is doing, for example what files they have open. Follow along with: Process Viewer Guide","title":"Process Viewer"},{"location":"Windows/Tools/#tcp-view","text":"This tool provides detailed information about the network communications of the local computer and can be used to monitor for malicious programs attempting to steal data For a brief overview: TCP View overview","title":"TCP View"},{"location":"Windows/Tools/#ad-password-control-bulk-password-control","text":"This tool is designed to allow for Domain wide account control and includes a random password generator. For the basic functionality: Password Control For bulk control: Bulk Password Control","title":"AD Password Control &amp; Bulk Password Control"}]}